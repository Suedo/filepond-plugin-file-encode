/*
 * FilePondPluginFileEncode 1.0.3
 * Licensed under MIT, https://opensource.org/licenses/MIT
 * Please visit https://pqina.nl/filepond for details.
 */
const DataURIWorker=function(){self.onmessage=(t=>{e(t.data.message,e=>{self.postMessage({id:t.data.id,message:e})})});const e=(e,t)=>{const{file:a}=e,i=new FileReader;i.onloadend=(()=>{t(i.result.replace("data:","").replace(/^.+,/,""))}),i.readAsDataURL(a)}};var plugin$1=({addFilter:e,utils:t})=>{const{Type:a,createWorker:i,createRoute:r,applyFilterChain:o}=t;return e("CREATE_VIEW",e=>{const{is:t,view:a,query:n}=e;if(!t("file-wrapper")||!n("GET_ALLOW_FILE_ENCODE"))return;a.registerWriter(r({DID_LOAD_ITEM:({root:e,action:t})=>{n("IS_ASYNC")||e.dispatch("FILE_ENCODE_ITEM",t,!0)},FILE_ENCODE_ITEM:({root:e,action:t})=>{const a=n("GET_ITEM",t.id),r=a.file;o("PREPARE_OUTPUT",r,{query:n,item:a}).then(t=>{i(DataURIWorker).post({file:t},i=>{e.ref.data.value=JSON.stringify({id:a.id,name:t.name,type:t.type,size:t.size,metadata:a.getMetadata(),data:i})})}).catch(e=>{console.error(e)})}}))}),{options:{allowFileEncode:[!0,a.BOOLEAN]}}};document&&document.dispatchEvent(new CustomEvent("FilePond:pluginloaded",{detail:plugin$1}));export default plugin$1;