/*
 * FilePondPluginFileEncode 1.0.4
 * Licensed under MIT, https://opensource.org/licenses/MIT
 * Please visit https://pqina.nl/filepond for details.
 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.FilePondPluginFileEncode=t()}(this,function(){"use strict";var e=function(){self.onmessage=function(t){e(t.data.message,function(e){self.postMessage({id:t.data.id,message:e})})};var e=function(e,t){var n=e.file,a=new FileReader;a.onloadend=function(){t(a.result.replace("data:","").replace(/^.+,/,""))},a.readAsDataURL(n)}},t=function(t){var n=t.addFilter,a=t.utils,i=a.Type,o=a.createWorker,r=a.createRoute;return n("SHOULD_PREPARE_OUTPUT",function(e){return new Promise(function(e,t){e(!0)})}),n("COMPLETE_PREPARE_OUTPUT",function(t,n){var a=n.item;return new Promise(function(n,i){var r=a.getMetadata();delete r.base64;var d=o(e);d.post({file:t},function(e){a.setMetadata("base64",e),n(t)})})}),n("CREATE_VIEW",function(e){var t=e.is,n=e.view,a=e.query;t("file-wrapper")&&a("GET_ALLOW_FILE_ENCODE")&&n.registerWriter(r({DID_LOAD_ITEM:function(e){var t=e.root,n=e.action;if(!a("IS_ASYNC")){var i=a("GET_ITEM",n.id),o=i.getMetadata(),r=o.base64;delete o.base64,t.ref.data.value=JSON.stringify({id:i.id,name:i.file.name,type:i.file.type,size:i.file.size,metadata:o,data:r})}}}))}),{options:{allowFileEncode:[!0,i.BOOLEAN]}}};return"undefined"!=typeof navigator&&document&&document.dispatchEvent(new CustomEvent("FilePond:pluginloaded",{detail:t})),t});